import{B as e,Ct as t,D as n,E as r,Et as i,F as a,H as o,I as s,J as c,K as l,L as u,N as d,O as f,P as p,R as m,St as h,U as g,V as _,W as v,Y as y,bt as b,ct as x,et as S,it as C,mt as w,nt as T,q as E,rt as D,st as O,w as k,x as A,xt as j,z as M}from"./BUwZQTr6.js";import{d as N,p as P}from"./_v7-ePgP.js";import{t as F}from"./Bxfoq5Is.js";import"./BaYFa2sV.js";import{E as I,O as L,b as R,d as z,l as B,r as V}from"./BNAMIMxA.js";import{c as H,d as U,f as W,i as G,m as K,p as q,s as J,u as Y}from"./CE_dLVT9.js";import{n as ee,t as X}from"./BjXhW6l8.js";import{c as te,d as ne,m as re,n as ie,r as ae,s as oe,t as se,u as ce}from"./D2kYZRJ8.js";import{t as le}from"./-DwGYZJK.js";import{t as Z}from"./BAU4SYdC.js";import{a as ue,i as de,n as fe,o as pe,r as me,t as he}from"./C946lkt1.js";import{t as ge}from"./YM027S49.js";const Q=f(`proxies`,()=>{let e=F(),t=ee(),n=w([]),r=w([]),i=w({}),a=w({}),o=w({}),s=w({}),c=w({}),l=w({}),u=w(!1),d=k(`collapsedMap`,{}),f=(t,n=!0)=>{let r=t.extra||{},i=Object.keys(r).reduce((t,n)=>{let i=r[n],a=i?.history?.at(-1)?.delay??e.latencyQualityMap.NOT_CONNECTED;return t.allTestUrlLatency[n]=a,t.allTestUrlLatencyHistory[n]=i?.history,t},{allTestUrlLatency:{},allTestUrlLatencyHistory:{}});if(n){let n=t.testUrl||e.urlForLatencyTest;if(!(n in i.allTestUrlLatency)){let r=t.history?.at(-1)?.delay??e.latencyQualityMap.NOT_CONNECTED;i.allTestUrlLatency[n]=r,i.allTestUrlLatencyHistory[n]=t.history}}return i},p=e=>{let t={...a.value},n={...i.value};e.forEach(e=>{let{allTestUrlLatency:r,allTestUrlLatencyHistory:i}=f(e),{udp:a,xudp:o,type:s,now:c,name:l,tfo:u,provider:d=``}=e;t[e.name]={udp:a,xudp:o,type:s,latency:c,latencyTestHistory:i,name:l,tfo:u,provider:d},n[e.name]=r}),a.value=t,i.value=n},m=async()=>{let[{providers:e},{proxies:t}]=await Promise.all([H(),J()]),i=Object.values(t).map(t=>{if(t.all?.length&&!t.testUrl){let{testUrl:n,timeout:r}=e?.[t.name]||{};return{...t,testUrl:n,timeout:r}}return t}),a=[...t.GLOBAL?.all??[],`GLOBAL`],o=Object.values(i).filter(e=>e.all?.length).sort((e,t)=>a.indexOf(e.name)-a.indexOf(t.name)),s=Object.values(e).filter(e=>e.name!==`default`&&e.vehicleType!==`Compatible`),c=[...i,...s.flatMap(e=>e.proxies.filter(e=>!(e.name in t)).map(t=>({...t,provider:e.name})))];n.value=o,r.value=s,p(c)},h=async(n,r)=>{if(await q(n.name,r),await m(),e.autoCloseConns){let e=t.restructRawMsgToConnection(t.latestConnectionMsg?.connections??[],[]);e.length>0&&e.forEach(({id:e,chains:t})=>{t.includes(n.name)&&G(e)})}},g=e=>{let t=a.value[e];if(!e||!t)return e;for(;t&&t.latency&&t.latency!==t.name;){let e=a.value[t.latency];if(!e)return t.name;t=e}return t?.name??e};return{proxies:n,proxyProviders:r,latencyMap:i,proxyNodeMap:a,proxyLatencyTestingMap:o,proxyGroupLatencyTestingMap:s,proxyProviderLatencyTestingMap:c,updatingMap:l,isAllProviderUpdating:u,collapsedMap:d,fetchProxies:m,selectProxyInGroup:h,getNowProxyNodeName:g,getLatencyByName:(t,n)=>{let r=n||e.urlForLatencyTest,a=i.value,o=g(t),s=a[o]?.[r],c=a[t]?.[r];if(s!=null)return s;if(c!=null)return c;let l=a[o];if(l&&Object.keys(l).length>0){let e=Object.keys(l),t=l[r]==null?e[0]:r;if(t)return l[t]}let u=a[t];if(u&&Object.keys(u).length>0){let e=Object.keys(u);if(e[0])return u[e[0]]}return e.latencyQualityMap.NOT_CONNECTED},getLatencyHistoryByName:(t,n)=>{let r=a.value[t],i=g(t),o=a.value[i],s=n||e.urlForLatencyTest,c=o?.latencyTestHistory[s]||r?.latencyTestHistory[s];if(c&&c.length)return c;let l=o?.latencyTestHistory||{},u=Object.keys(l)[0];if(u){let e=l[u];if(e&&e.length)return e}let d=r?.latencyTestHistory||{},f=Object.keys(d)[0];if(f){let e=d[f];if(e&&e.length)return e}return[]},isProxyGroup:e=>{let t=a.value[e];return t?[`direct`,`reject`,`loadbalance`].includes(t.type.toLowerCase())||!!t.latency:!1},proxyLatencyTest:async(t,n,r,a)=>{let s=g(t);o.value[s]=!0;try{let t=r||e.urlForLatencyTest,o=i.value?.[s]||{},{delay:c}=await U(s,n,t,a??e.latencyTestTimeoutDuration);o[t]=c,i.value={...i.value,[s]:o}}catch{let t=r||e.urlForLatencyTest,n=i.value?.[s]||{};n[t]=e.latencyQualityMap.NOT_CONNECTED,i.value={...i.value,[s]:n}}finally{o.value[s]=!1}},proxyGroupLatencyTest:async t=>{s.value[t]=!0;try{let r=n.value.find(e=>e.name===t);await Y(t,r?.testUrl||e.urlForLatencyTest,r?.timeout??e.latencyTestTimeoutDuration),await m()}finally{s.value[t]=!1}},updateProviderByProviderName:async e=>{l.value[e]=!0;try{await K(e)}catch{}await m(),l.value[e]=!1},updateAllProvider:async()=>{u.value=!0;try{await Promise.allSettled(r.value.map(e=>K(e.name))),await m()}finally{u.value=!1}},proxyProviderLatencyTest:async e=>{c.value[e]=!0;try{await W(e),await m()}finally{c.value[e]=!1}}}});var _e={key:0,class:`loading loading-sm loading-infinity`},ve=c({__name:`Latency`,props:{proxyName:{},testUrl:{},class:{}},emits:[`click`],setup(e){let n=e,r=Q(),i=F(),a=M(()=>n.class||``),o=M(()=>r.getLatencyByName(n.proxyName,n.testUrl)),s=M(()=>r.proxyLatencyTestingMap[n.proxyName]||!1),c=M(()=>ce(o.value,i.latencyQualityMap)),d=M(()=>o.value||`---`);return(e,n)=>(T(),g(`span`,{class:j([`badge flex w-11 items-center justify-center whitespace-nowrap`,[b(c),b(a)]]),onClick:n[0]||=t=>e.$emit(`click`,t)},[b(s)?(T(),g(`span`,_e)):(T(),g(u,{key:1},[l(t(b(d)),1)],64))],2))}}),$=Object.assign(ve,{__name:`Latency`}),ye={class:`flex items-center gap-2`},be={class:`my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl *:h-2`},xe=c({__name:`ProxyPreviewBar`,props:{proxyNameList:{},testUrl:{},now:{}},setup(t){let n=t,r=Q(),i=F(),a=M(()=>n.proxyNameList.map(e=>r.getLatencyByName(e,n.testUrl))),s=M(()=>a.value.length||1),c=M(()=>a.value.filter(e=>e>i.latencyQualityMap.NOT_CONNECTED&&e<=i.latencyQualityMap.MEDIUM).length),l=M(()=>a.value.filter(e=>e>i.latencyQualityMap.MEDIUM&&e<=i.latencyQualityMap.HIGH).length),u=M(()=>a.value.filter(e=>e>i.latencyQualityMap.HIGH).length),d=M(()=>a.value.filter(e=>e===i.latencyQualityMap.NOT_CONNECTED).length),f=M(()=>c.value*100/s.value),p=M(()=>l.value*100/s.value),m=M(()=>u.value*100/s.value),v=M(()=>d.value*100/s.value);return(n,r)=>{let i=$;return T(),g(`div`,ye,[e(`div`,be,[e(`div`,{class:`bg-green-600`,style:h({width:`${b(f)}%`})},null,4),e(`div`,{class:`bg-yellow-500`,style:h({width:`${b(p)}%`})},null,4),e(`div`,{class:`bg-red-500`,style:h({width:`${b(m)}%`})},null,4),e(`div`,{class:`bg-neutral`,style:h({width:`${b(v)}%`})},null,4)]),t.now?(T(),_(i,{key:0,"proxy-name":t.now,"test-url":t.testUrl},null,8,[`proxy-name`,`test-url`])):o(``,!0)])}}}),Se=Object.assign(xe,{__name:`ProxyPreviewBar`}),Ce={class:`flex items-center gap-2`},we={class:`flex flex-1 flex-wrap items-center gap-1`},Te=[`title`,`onClick`],Ee=c({__name:`ProxyPreviewDots`,props:{proxyNameList:{},testUrl:{},now:{},onSelect:{type:Function}},setup(t){let n=t,r=Q(),i=F(),a=M(()=>n.proxyNameList.map(e=>[e,r.getLatencyByName(e,n.testUrl)]));function c(e,t){let n=i.latencyQualityMap.NOT_CONNECTED,r=i.latencyQualityMap.MEDIUM,a=i.latencyQualityMap.HIGH;return typeof e!=`number`||e===n?t?`bg-white border-4 border-neutral`:`bg-neutral`:e>a?t?`bg-white border-4 border-red-500`:`bg-red-500`:e>r?t?`bg-white border-4 border-yellow-500`:`bg-yellow-500`:t?`bg-white border-4 border-green-600`:`bg-green-600`}return(n,r)=>{let i=$;return T(),g(`div`,Ce,[e(`div`,we,[(T(!0),g(u,null,D(b(a),([e,n])=>(T(),g(`div`,{key:e,class:j([`h-4 w-4 rounded-full`,[c(n,e===t.now),t.onSelect&&`cursor-pointer transition-transform hover:scale-125`]]),title:e,onClick:s(n=>t.onSelect&&t.onSelect(e),[`stop`])},null,10,Te))),128))]),t.now?(T(),_(i,{key:0,"proxy-name":t.now,"test-url":t.testUrl},null,8,[`proxy-name`,`test-url`])):o(``,!0)])}}}),De=Object.assign(Ee,{__name:`ProxyPreviewDots`}),Oe=c({__name:`ProxyNodePreview`,props:{proxyNameList:{},testUrl:{},now:{},onSelect:{type:Function}},setup(e){let t=e,n=F(),r=M(()=>n.proxiesPreviewType===P.OFF),i=M(()=>t.proxyNameList.length<=10),a=M(()=>{let e=n.proxiesPreviewType;return e===P.BAR||e===P.Auto&&!i.value}),s=M(()=>{let e=n.proxiesPreviewType;return e===P.DOTS||e===P.Auto&&i.value});return(t,n)=>{let i=Se,c=De;return b(r)?o(``,!0):(T(),g(u,{key:0},[b(a)?(T(),_(i,{key:0,"proxy-name-list":e.proxyNameList,"test-url":e.testUrl,now:e.now},null,8,[`proxy-name-list`,`test-url`,`now`])):b(s)?(T(),_(c,{key:1,"proxy-name-list":e.proxyNameList,"test-url":e.testUrl,now:e.now,"on-select":e.onSelect},null,8,[`proxy-name-list`,`test-url`,`now`,`on-select`])):o(``,!0)],64))}}}),ke=Object.assign(Oe,{__name:`ProxyNodePreview`}),Ae=i(re(),1),je={class:`min-w-0 flex-1 truncate text-sm font-medium`},Me={key:1,class:`badge shrink-0 badge-xs badge-info`},Ne={key:2,class:`hidden text-xs uppercase opacity-60 sm:inline`},Pe={class:`hidden text-xs uppercase opacity-75 sm:inline`},Fe={class:`flex flex-col items-center gap-2`},Ie={class:`text-lg font-bold`},Le={key:0,class:`w-full text-xs uppercase`},Re={key:1,class:`timeline timeline-vertical timeline-compact max-h-60 overflow-y-auto timeline-snap-icon`},ze={key:0},Be={class:`timeline-start space-y-2`},Ve={class:`text-sm italic`},He={class:`timeline-middle`},Ue={key:1},We={key:2,class:`text-sm opacity-75`},Ge=c({__name:`ProxyNodeListItem`,props:{proxyName:{},testUrl:{},timeout:{},isSelected:{type:Boolean,default:!1}},emits:[`click`],setup(n,{emit:r}){let i=n,a=r,c=Q(),l=F(),{t:d}=A(),f=M(()=>c.proxyNodeMap[i.proxyName]),p=M(()=>oe(f.value?.type||``,d)),v=M(()=>f.value?.xudp||f.value?.udp),y=M(()=>c.proxyLatencyTestingMap[i.proxyName]||!1),x=M(()=>!f.value||!ae(f.value.type)?null:[f.value.xudp&&`xudp`,f.value.udp&&`udp`,f.value.tfo&&`TFO`].filter(Boolean).join(` / `)),S=M(()=>c.getLatencyHistoryByName(i.proxyName,i.testUrl).toReversed()),C=w(null),O=w(null),k=w(null),N=w(!1),{floatingStyles:P,middlewareData:I,placement:L}=fe(C,O,{placement:`top`,middleware:[ue(10),de(),pe({padding:8}),he({element:k})],whileElementsMounted:me}),R=M(()=>{let e=I.value.arrow,t={top:`bottom`,right:`left`,bottom:`top`,left:`right`}[L.value.split(`-`)[0]||`top`]||`bottom`;return{left:e?.x==null?``:`${e.x}px`,top:e?.y==null?``:`${e.y}px`,[t]:`-4px`}}),z=null,B=null;function H(){z&&=(clearTimeout(z),null),B&&=(clearTimeout(B),null)}function U(){H(),z=setTimeout(()=>{N.value=!0},300)}function W(){H(),B=setTimeout(()=>{N.value=!1},100)}function G(){H()}function K(){H(),N.value=!1}function q(){a(`click`)}function J(){c.proxyLatencyTest(i.proxyName,f.value?.provider||``,i.testUrl,i.timeout)}return(r,i)=>{let a=$;return T(),g(`div`,{ref_key:`reference`,ref:C,class:j([`relative rounded-lg`,[n.isSelected?`bg-primary text-primary-content`:`bg-neutral text-neutral-content`]]),onMouseenter:U,onMouseleave:W},[e(`div`,{class:j([`flex items-center gap-2 px-3 py-1.5`,{"cursor-pointer hover:opacity-80":!!q}]),onClick:q},[n.isSelected?(T(),_(b(V),{key:0,class:`size-4 shrink-0`})):o(``,!0),e(`span`,je,t(n.proxyName),1),b(v)?(T(),g(`span`,Me,`U`)):o(``,!0),b(x)?(T(),g(`span`,Ne,t(b(x)),1)):o(``,!0),e(`span`,Pe,t(b(p)),1),E(a,{"proxy-name":n.proxyName,"test-url":n.testUrl,class:j([`shrink-0`,{"animate-pulse":b(y)}]),onClick:s(J,[`stop`])},null,8,[`proxy-name`,`test-url`,`class`])],2),(T(),_(m,{to:`body`},[b(N)?(T(),g(`div`,{key:0,ref_key:`floating`,ref:O,style:h(b(P)),class:`z-50 w-max max-w-xs rounded-box bg-primary p-2.5 text-primary-content shadow-lg`,onMouseenter:G,onMouseleave:K},[e(`div`,{ref_key:`floatingArrow`,ref:k,class:`absolute size-2 rotate-45 bg-primary`,style:h(b(R))},null,4),e(`div`,Fe,[e(`h2`,Ie,t(n.proxyName),1),b(x)?(T(),g(`div`,Le,` (`+t(b(x))+`) `,1)):o(``,!0),b(S).length>0?(T(),g(`ul`,Re,[(T(!0),g(u,null,D(b(S),(n,r)=>(T(),g(`li`,{key:r},[r>0?(T(),g(`hr`,ze)):o(``,!0),e(`div`,Be,[e(`time`,Ve,t(b(Ae.default)(n.time).format(`YYYY-MM-DD HH:mm:ss`)),1),e(`div`,{class:j([`badge block`,b(ce)(n.delay,b(l).latencyQualityMap)])},t(n.delay||`---`),3)]),e(`div`,He,[E(b(V),{class:`size-4`})]),r===b(S).length-1?o(``,!0):(T(),g(`hr`,Ue))]))),128))])):(T(),g(`div`,We,t(b(d)(`noLatencyHistory`)),1))])],36)):o(``,!0)]))],34)}}}),Ke=Object.assign(Ge,{__name:`ProxyNodeListItem`}),qe=i(re(),1),Je={key:0,class:`indicator-item badge badge-xs badge-info`},Ye={class:`card-title line-clamp-1 text-start text-sm break-all`},Xe={class:`card-actions items-end justify-between gap-1`},Ze={class:`flex flex-col gap-0.5`},Qe={class:`text-xs font-semibold uppercase opacity-75`},$e={class:`flex flex-col items-center gap-2`},et={class:`text-lg font-bold`},tt={key:0,class:`w-full text-xs uppercase`},nt={key:1,class:`timeline timeline-vertical timeline-compact max-h-60 overflow-y-auto timeline-snap-icon`},rt={key:0},it={class:`timeline-start space-y-2`},at={class:`text-sm italic`},ot={class:`timeline-middle`},st={key:1},ct={key:2,class:`text-sm opacity-75`},lt=c({__name:`ProxyNodeCard`,props:{proxyName:{},testUrl:{},timeout:{},isSelected:{type:Boolean,default:!1}},emits:[`click`],setup(n,{emit:r}){let i=n,a=r,c=Q(),l=F(),{t:d}=A(),f=M(()=>c.proxyNodeMap[i.proxyName]),p=M(()=>oe(f.value?.type||``,d)),v=M(()=>f.value?.xudp||f.value?.udp),y=M(()=>c.proxyLatencyTestingMap[i.proxyName]||!1),x=M(()=>ae(f.value?.type)?`(${[f.value?.xudp&&`xudp`,f.value?.udp&&`udp`,f.value?.tfo&&`TFO`].filter(Boolean).join(` / `)})`:null),S=M(()=>c.getLatencyHistoryByName(i.proxyName,i.testUrl).toReversed()),C=w(null),O=w(null),k=w(null),N=w(!1),{floatingStyles:P,middlewareData:I,placement:L}=fe(C,O,{placement:`top`,middleware:[ue(10),de(),pe({padding:8}),he({element:k})],whileElementsMounted:me}),R=M(()=>{let e=I.value.arrow,t={top:`bottom`,right:`left`,bottom:`top`,left:`right`}[L.value.split(`-`)[0]||`top`]||`bottom`;return{left:e?.x==null?``:`${e.x}px`,top:e?.y==null?``:`${e.y}px`,[t]:`-4px`}}),z=null,B=null;function H(){z&&=(clearTimeout(z),null),B&&=(clearTimeout(B),null)}function U(){H(),z=setTimeout(()=>{N.value=!0},300)}function W(){H(),B=setTimeout(()=>{N.value=!1},100)}function G(){H()}function K(){H(),N.value=!1}function q(){a(`click`)}function J(){c.proxyLatencyTest(i.proxyName,f.value?.provider||``,i.testUrl,i.timeout)}return(r,i)=>{let a=$;return T(),g(`div`,{ref_key:`reference`,ref:C,class:j([`indicator card relative w-full`,[n.isSelected?`bg-primary text-primary-content`:`bg-neutral text-neutral-content`]]),onMouseenter:U,onMouseleave:W},[b(v)?(T(),g(`div`,Je,`U`)):o(``,!0),e(`div`,{class:j([`card-body gap-1 space-y-1 p-2.5`,{"cursor-pointer":!!q}]),onClick:q},[e(`h2`,Ye,t(n.proxyName),1),e(`div`,Xe,[e(`div`,Ze,[e(`div`,Qe,t(b(p)),1)]),E(a,{"proxy-name":n.proxyName,"test-url":n.testUrl,class:j({"animate-pulse":b(y)}),onClick:s(J,[`stop`])},null,8,[`proxy-name`,`test-url`,`class`])])],2),(T(),_(m,{to:`body`},[b(N)?(T(),g(`div`,{key:0,ref_key:`floating`,ref:O,style:h(b(P)),class:`z-50 w-max max-w-xs rounded-box bg-primary p-2.5 text-primary-content shadow-lg`,onMouseenter:G,onMouseleave:K},[e(`div`,{ref_key:`floatingArrow`,ref:k,class:`absolute size-2 rotate-45 bg-primary`,style:h(b(R))},null,4),e(`div`,$e,[e(`h2`,et,t(n.proxyName),1),b(x)?(T(),g(`div`,tt,t(b(x)),1)):o(``,!0),b(S).length>0?(T(),g(`ul`,nt,[(T(!0),g(u,null,D(b(S),(n,r)=>(T(),g(`li`,{key:r},[r>0?(T(),g(`hr`,rt)):o(``,!0),e(`div`,it,[e(`time`,at,t(b(qe.default)(n.time).format(`YYYY-MM-DD HH:mm:ss`)),1),e(`div`,{class:j([`badge block`,b(ce)(n.delay,b(l).latencyQualityMap)])},t(n.delay||`---`),3)]),e(`div`,ot,[E(b(V),{class:`size-4`})]),r===b(S).length-1?o(``,!0):(T(),g(`hr`,st))]))),128))])):(T(),g(`div`,ct,t(b(d)(`noLatencyHistory`)),1))])],36)):o(``,!0)]))],34)}}}),ut=Object.assign(lt,{__name:`ProxyNodeCard`}),dt=i(re(),1),ft={class:`flex items-center gap-2 pt-1`},pt=[`value`],mt={class:`badge badge-sm badge-secondary`},ht={class:`flex flex-wrap items-center justify-between`},gt={class:`text-sm text-slate-500`},_t={class:`text-sm text-slate-500`},vt=c({__name:`SubscriptionInfo`,props:{subscriptionInfo:{}},setup(n){let r=n,{t:i}=A(),a=M(()=>r.subscriptionInfo?X(r.subscriptionInfo.Total||0,{units:`iec`}).toString():`0 B`),s=M(()=>{if(!r.subscriptionInfo)return`0 B`;let{Download:e=0,Upload:t=0}=r.subscriptionInfo;return X(e+t,{units:`iec`}).toString()}),c=M(()=>{if(!r.subscriptionInfo?.Total)return 0;let{Download:e=0,Upload:t=0,Total:n=1}=r.subscriptionInfo;return Math.min(Number(((e+t)/n*100).toFixed(1)),999)}),l=M(()=>r.subscriptionInfo?.Expire?(0,dt.default)(r.subscriptionInfo.Expire*1e3).format(`YYYY-MM-DD`):i(`noExpire`));return(r,d)=>n.subscriptionInfo?(T(),g(u,{key:0},[e(`div`,ft,[e(`progress`,{class:`progress`,value:b(c),max:`100`},null,8,pt),e(`div`,mt,t(b(c))+`%`,1)]),e(`div`,ht,[e(`div`,gt,t(b(s))+` / `+t(b(a)),1),e(`div`,_t,t(b(i)(`expire`))+`: `+t(b(l)),1)])],64)):o(``,!0)}}),yt=Object.assign(vt,{__name:`SubscriptionInfo`}),bt=c({__name:`Collapse`,props:{isOpen:{type:Boolean,default:!1}},emits:[`collapse`],setup(t,{emit:n}){let r=n,i=F(),a=M(()=>i.proxiesDisplayMode===N.LIST);return(n,i)=>(T(),g(`div`,{class:j([`collapse-arrow collapse border-secondary bg-base-200 shadow-md select-none`,t.isOpen?`collapse-open`:`collapse-close`])},[e(`div`,{class:`collapse-title pr-4 text-xl font-medium after:top-8!`,onClick:i[0]||=e=>r(`collapse`,!t.isOpen)},[C(n.$slots,`title`)]),e(`div`,{class:j([`collapse-content transition-opacity duration-1000`,[t.isOpen?`opacity-100`:`opacity-0`,b(a)?`flex flex-col gap-1`:`grid gap-2`]]),style:h(b(a)?void 0:`grid-template-columns: repeat(auto-fill, minmax(200px, 1fr))`)},[t.isOpen?C(n.$slots,`default`,{key:0}):o(``,!0)],6)],2))}}),xt=Object.assign(bt,{__name:`Collapse`}),St={key:0,class:`flex gap-2`},Ct={class:`flex-1 space-y-2`},wt={class:`flex-1 space-y-2`},Tt={key:1,class:`space-y-2`},Et=c({__name:`ProxiesRenderWrapper`,setup(t,{expose:n}){let i=F(),{width:a}=r(),o=M(()=>a.value>480),s=M(()=>i.renderProxiesInTwoColumns&&o.value);return n({isTwoColumns:s}),(t,n)=>b(s)?(T(),g(`div`,St,[e(`div`,Ct,[C(t.$slots,`even`)]),e(`div`,wt,[C(t.$slots,`odd`)])])):(T(),g(`div`,Tt,[C(t.$slots,`default`)]))}}),Dt=Object.assign(Et,{__name:`ProxiesRenderWrapper`}),Ot={class:`flex h-full flex-col gap-2`},kt={class:`flex items-center gap-2`},At={class:`tabs-box tabs gap-2 tabs-sm`},jt=[`onClick`],Mt={class:`badge badge-sm`},Nt={class:`ml-auto`},Pt={key:0,class:`flex-1 overflow-y-auto`},Ft={key:1,class:`flex-1 overflow-y-auto`},It={class:`flex flex-col gap-4`},Lt={class:`flex w-full justify-center`},Rt={class:`flex flex-col`},zt={value:`orderNatural`},Bt={value:`orderLatency_asc`},Vt={value:`orderLatency_desc`},Ht={value:`orderName_asc`},Ut={value:`orderName_desc`},Wt={class:`flex w-full justify-center`},Gt={class:`flex w-full justify-center`},Kt={value:`cardMode`},qt={value:`listMode`},Jt={value:`auto`},Yt={value:`dots`},Xt={value:`bar`},Zt={value:`off`},Qt=c({__name:`proxies`,setup(r){let{t:i,locale:s}=A();n({title:M(()=>i(`proxies`))});let f=Q(),m=ee(),h=F(),C=w(`proxies`),k=w(),N=w(),P=w(),V=e=>X(e).toString(),H=M(()=>f.proxies.filter(e=>!e.hidden)),U=M(()=>[{type:`proxies`,name:i(`proxies`),count:H.value.length},{type:`proxyProviders`,name:i(`proxyProviders`),count:f.proxyProviders.length}]);function W(e){return ie({proxyNames:ne({proxyNames:e.all??[],orderingType:h.proxiesOrderingType,testUrl:e.testUrl||null,getLatencyByName:f.getLatencyByName,latencyQualityMap:h.latencyQualityMap,urlForLatencyTest:h.urlForLatencyTest}),enabled:h.hideUnAvailableProxies,testUrl:e.testUrl||null,getLatencyByName:f.getLatencyByName,isProxyGroup:f.isProxyGroup,latencyQualityMap:h.latencyQualityMap,urlForLatencyTest:h.urlForLatencyTest})}function G(e){return ne({proxyNames:e.proxies.map(e=>e.name),orderingType:h.proxiesOrderingType,testUrl:e.testUrl,getLatencyByName:f.getLatencyByName,latencyQualityMap:h.latencyQualityMap,urlForLatencyTest:h.urlForLatencyTest})}S(()=>{f.fetchProxies()});let K=c({props:{proxyGroup:{type:Object,required:!0},sortedProxyNames:{type:Array,required:!0}},setup(e){return()=>y(`div`,{class:`space-y-2`},[y(`div`,{class:`flex items-center justify-between pr-8`},[y(`div`,{class:`flex items-center`},[e.proxyGroup.icon&&(e.proxyGroup.icon.startsWith(`data:image/svg+xml`)?y(`div`,{style:{height:`${h.iconHeight}px`,width:`${h.iconHeight}px`,color:`oklch(var(--p) / var(--tw-bg-opacity))`,backgroundColor:`currentColor`,marginRight:`${h.iconMarginRight}px`,maskImage:`url('${se(e.proxyGroup.icon)}')`,maskSize:`100% 100%`}}):y(`img`,{src:e.proxyGroup.icon,style:{height:`${h.iconHeight}px`,marginRight:`${h.iconMarginRight}px`}})),y(`span`,e.proxyGroup.name),y(`div`,{class:`badge badge-sm ml-2`},e.proxyGroup.all?.length)]),y(Z,{class:`btn-circle btn-sm`,disabled:f.proxyGroupLatencyTestingMap[e.proxyGroup.name],onClick:t=>{t.stopPropagation(),f.proxyGroupLatencyTest(e.proxyGroup.name)}},()=>y(L,{class:{"animate-pulse text-success":f.proxyGroupLatencyTestingMap[e.proxyGroup.name]}}))]),y(`div`,{class:`flex flex-wrap items-center justify-between gap-2`},[y(`div`,{class:`badge badge-primary badge-sm`},[y(`span`,{class:`font-bold`},oe(e.proxyGroup.type,i)),e.proxyGroup.now?.length>0&&[y(I,{size:18}),y(`span`,{class:`whitespace-nowrap`},e.proxyGroup.now)]]),y(`div`,{class:`badge badge-secondary badge-sm`},`${V(m.speedGroupByName[e.proxyGroup.name]||0)}/s`)]),!f.collapsedMap[e.proxyGroup.name]&&y(ke,{proxyNameList:e.sortedProxyNames,now:e.proxyGroup.now,testUrl:e.proxyGroup.testUrl||null,onSelect:t=>f.selectProxyInGroup(e.proxyGroup,t)})])}}),q=c({props:{proxyGroup:{type:Object,required:!0},sortedProxyNames:{type:Array,required:!0}},setup(e){return()=>e.sortedProxyNames.map(t=>h.proxiesDisplayMode===`listMode`?y(Ke,{key:t,proxyName:t,testUrl:e.proxyGroup.testUrl||null,timeout:e.proxyGroup.timeout??null,isSelected:e.proxyGroup.now===t,onClick:()=>f.selectProxyInGroup(e.proxyGroup,t)}):y(ut,{key:t,proxyName:t,testUrl:e.proxyGroup.testUrl||null,timeout:e.proxyGroup.timeout??null,isSelected:e.proxyGroup.now===t,onClick:()=>f.selectProxyInGroup(e.proxyGroup,t)}))}}),J=c({props:{provider:{type:Object,required:!0},sortedProxyNames:{type:Array,required:!0}},setup(e){return()=>y(`div`,[y(`div`,{class:`flex items-center justify-between pr-8`},[y(`div`,{class:`flex flex-wrap items-center gap-1`},[y(`span`,{class:`line-clamp-1 break-all`},e.provider.name),y(`div`,{class:`badge badge-sm`},e.provider.proxies.length),y(`div`,{class:`badge badge-sm`},e.provider.vehicleType)]),y(`div`,{class:`flex items-center gap-2`},[y(Z,{class:`btn btn-circle btn-sm`,disabled:f.updatingMap[e.provider.name],onClick:t=>{t.stopPropagation(),f.updateProviderByProviderName(e.provider.name)}},()=>y(z,{class:{"animate-spin text-success":f.updatingMap[e.provider.name]}})),y(Z,{class:`btn btn-circle btn-sm`,disabled:f.proxyProviderLatencyTestingMap[e.provider.name],onClick:t=>{t.stopPropagation(),f.proxyProviderLatencyTest(e.provider.name)}},()=>y(L,{class:{"animate-pulse text-success":f.proxyProviderLatencyTestingMap[e.provider.name]}}))])]),y(yt,{subscriptionInfo:e.provider.subscriptionInfo}),y(`div`,{class:`flex flex-col gap-2`},[y(`div`,{class:`text-sm text-slate-500`},`${i(`updated`)} ${te(e.provider.updatedAt,s.value)}`),!f.collapsedMap[e.provider.name]&&y(ke,{proxyNameList:e.sortedProxyNames,testUrl:e.provider.testUrl})])])}}),Y=c({props:{provider:{type:Object,required:!0},sortedProxyNames:{type:Array,required:!0}},setup(e){return()=>e.sortedProxyNames.map(t=>h.proxiesDisplayMode===`listMode`?y(Ke,{key:t,proxyName:t,testUrl:e.provider.testUrl,timeout:e.provider.timeout??null}):y(ut,{key:t,proxyName:t,testUrl:e.provider.testUrl,timeout:e.provider.timeout??null}))}});return(n,r)=>{let s=xt,c=Dt,m=le,y=ge;return T(),g(`div`,Ot,[e(`div`,kt,[e(`div`,At,[(T(!0),g(u,null,D(b(U),n=>(T(),g(`button`,{key:n.type,class:j([`sm:tab-md tab gap-2 px-2`,{"bg-primary text-neutral!":b(C)===n.type}]),onClick:e=>C.value=n.type},[e(`span`,null,t(n.name),1),e(`div`,Mt,t(n.count),1)],10,jt))),128))]),b(C)===`proxyProviders`?(T(),_(Z,{key:0,class:`btn btn-circle btn-sm`,disabled:b(f).isAllProviderUpdating,onClick:b(f).updateAllProvider},{default:O(()=>[E(b(z),{class:j({"animate-spin text-success":b(f).isAllProviderUpdating})},null,8,[`class`])]),_:1},8,[`disabled`,`onClick`])):o(``,!0),e(`div`,Nt,[E(Z,{class:`btn-circle btn-sm btn-primary`,onClick:r[0]||=e=>b(k)?.open()},{default:O(()=>[E(b(B))]),_:1})])]),b(C)===`proxies`?(T(),g(`div`,Pt,[E(c,{ref_key:`proxyGroupsWrapper`,ref:N},v({_:2},[b(N)?.isTwoColumns?{name:`even`,fn:O(()=>[(T(!0),g(u,null,D(b(H).filter((e,t)=>t%2==0),(e,t)=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(K),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),default:O(()=>[E(b(q),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`0`}:void 0,b(N)?.isTwoColumns?{name:`odd`,fn:O(()=>[(T(!0),g(u,null,D(b(H).filter((e,t)=>t%2==1),(e,t)=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(K),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),default:O(()=>[E(b(q),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`1`}:void 0,b(N)?.isTwoColumns?void 0:{name:`default`,fn:O(()=>[(T(!0),g(u,null,D(b(H),e=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(K),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),default:O(()=>[E(b(q),{"proxy-group":e,"sorted-proxy-names":W(e)},null,8,[`proxy-group`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`2`}]),1536)])):(T(),g(`div`,Ft,[E(c,{ref_key:`providersWrapper`,ref:P},v({_:2},[b(P)?.isTwoColumns?{name:`even`,fn:O(()=>[(T(!0),g(u,null,D(b(f).proxyProviders.filter((e,t)=>t%2==0),e=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(J),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),default:O(()=>[E(b(Y),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`0`}:void 0,b(P)?.isTwoColumns?{name:`odd`,fn:O(()=>[(T(!0),g(u,null,D(b(f).proxyProviders.filter((e,t)=>t%2==1),e=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(J),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),default:O(()=>[E(b(Y),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`1`}:void 0,b(P)?.isTwoColumns?void 0:{name:`default`,fn:O(()=>[(T(!0),g(u,null,D(b(f).proxyProviders,e=>(T(),_(s,{key:e.name,"is-open":b(f).collapsedMap[e.name]||!1,onCollapse:t=>b(f).collapsedMap[e.name]=t},{title:O(()=>[E(b(J),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),default:O(()=>[E(b(Y),{provider:e,"sorted-proxy-names":G(e)},null,8,[`provider`,`sorted-proxy-names`])]),_:2},1032,[`is-open`,`onCollapse`]))),128))]),key:`2`}]),1536)])),E(y,{ref_key:`settingsModal`,ref:k,title:b(i)(`proxiesSettings`)},{icon:O(()=>[E(b(R),{size:24})]),default:O(()=>[e(`div`,It,[e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`autoCloseConns`)),1)]),_:1}),e(`div`,Lt,[x(e(`input`,{"onUpdate:modelValue":r[1]||=e=>b(h).autoCloseConns=e,class:`toggle`,type:`checkbox`},null,512),[[d,b(h).autoCloseConns]])])]),e(`div`,Rt,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`urlForLatencyTest`)),1)]),_:1}),x(e(`input`,{"onUpdate:modelValue":r[2]||=e=>b(h).urlForLatencyTest=e,class:`input w-full`,type:`text`},null,512),[[a,b(h).urlForLatencyTest]])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`latencyTestTimeoutDuration`))+` (`+t(b(i)(`ms`))+`) `,1)]),_:1}),x(e(`input`,{"onUpdate:modelValue":r[3]||=e=>b(h).latencyTestTimeoutDuration=e,class:`input w-full`,type:`number`},null,512),[[a,b(h).latencyTestTimeoutDuration,void 0,{number:!0}]])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`proxiesSorting`)),1)]),_:1}),x(e(`select`,{"onUpdate:modelValue":r[4]||=e=>b(h).proxiesOrderingType=e,class:`select w-full`},[e(`option`,zt,t(b(i)(`orderNatural`)),1),e(`option`,Bt,t(b(i)(`orderLatency_asc`)),1),e(`option`,Vt,t(b(i)(`orderLatency_desc`)),1),e(`option`,Ht,t(b(i)(`orderName_asc`)),1),e(`option`,Ut,t(b(i)(`orderName_desc`)),1)],512),[[p,b(h).proxiesOrderingType]])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`hideUnavailableProxies`)),1)]),_:1}),e(`div`,Wt,[x(e(`input`,{"onUpdate:modelValue":r[5]||=e=>b(h).hideUnAvailableProxies=e,class:`toggle`,type:`checkbox`},null,512),[[d,b(h).hideUnAvailableProxies]])])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`renderInTwoColumns`)),1)]),_:1}),e(`div`,Gt,[x(e(`input`,{"onUpdate:modelValue":r[6]||=e=>b(h).renderProxiesInTwoColumns=e,class:`toggle`,type:`checkbox`},null,512),[[d,b(h).renderProxiesInTwoColumns]])])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`proxiesDisplayMode`)),1)]),_:1}),x(e(`select`,{"onUpdate:modelValue":r[7]||=e=>b(h).proxiesDisplayMode=e,class:`select w-full`},[e(`option`,Kt,t(b(i)(`cardMode`)),1),e(`option`,qt,t(b(i)(`listMode`)),1)],512),[[p,b(h).proxiesDisplayMode]])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`proxiesPreviewType`)),1)]),_:1}),x(e(`select`,{"onUpdate:modelValue":r[8]||=e=>b(h).proxiesPreviewType=e,class:`select w-full`},[e(`option`,Jt,t(b(i)(`auto`)),1),e(`option`,Yt,t(b(i)(`dots`)),1),e(`option`,Xt,t(b(i)(`bar`)),1),e(`option`,Zt,t(b(i)(`off`)),1)],512),[[p,b(h).proxiesPreviewType]])]),e(`div`,null,[E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`iconHeight`)),1)]),_:1}),x(e(`input`,{"onUpdate:modelValue":r[9]||=e=>b(h).iconHeight=e,class:`input w-full`,type:`number`},null,512),[[a,b(h).iconHeight,void 0,{number:!0}]]),E(m,{"with-divider":``},{default:O(()=>[l(t(b(i)(`iconMarginRight`)),1)]),_:1}),x(e(`input`,{"onUpdate:modelValue":r[10]||=e=>b(h).iconMarginRight=e,class:`input w-full`,type:`number`},null,512),[[a,b(h).iconMarginRight,void 0,{number:!0}]])]),e(`div`,null,[e(`button`,{class:`btn w-full btn-error`,onClick:r[11]||=e=>b(h).resetProxiesSettings()},t(b(i)(`resetSettings`)),1)])])]),_:1},8,[`title`])])}}});export{Qt as default};