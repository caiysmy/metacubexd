import{B as e,Ct as t,D as n,Et as r,F as i,H as a,I as o,J as s,K as c,L as l,P as u,U as d,V as f,Y as p,at as m,bt as h,ct as g,mt as _,nt as v,ot as ee,q as y,rt as b,st as x,ut as te,w as S,x as C,xt as w,z as T}from"./BUwZQTr6.js";import{i as E,n as D}from"./_v7-ePgP.js";import{t as ne}from"./Bxfoq5Is.js";import"./BaYFa2sV.js";import{D as O,E as re,T as k,c as A,f as j,h as M,i as ie,l as N,n as P,p as F,s as I,t as L,w as R}from"./BNAMIMxA.js";import{i as ae,r as oe}from"./CE_dLVT9.js";import{i as z,n as se,r as ce,t as B}from"./BjXhW6l8.js";import{c as le,m as V,o as ue}from"./D2kYZRJ8.js";import{t as de}from"./-DwGYZJK.js";import{t as H}from"./BAU4SYdC.js";import{t as fe}from"./YM027S49.js";function pe(e){var t=typeof e;return e!=null&&(t==`object`||t==`function`)}var me=pe,he=`[object AsyncFunction]`,ge=`[object Function]`,_e=`[object GeneratorFunction]`,U=`[object Proxy]`;function W(e){if(!me(e))return!1;var t=ce(e);return t==ge||t==_e||t==he||t==U}var G=W,K=z[`__core-js_shared__`],ve=function(){var e=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||``);return e?`Symbol(src)_1.`+e:``}();function ye(e){return!!ve&&ve in e}var be=ye,xe=Function.prototype.toString;function Se(e){if(e!=null){try{return xe.call(e)}catch{}try{return e+``}catch{}}return``}var Ce=Se,we=/[\\^$.*+?()[\]{}|]/g,Te=/^\[object .+?Constructor\]$/,Ee=Function.prototype,De=Object.prototype,Oe=Ee.toString,ke=De.hasOwnProperty,Ae=RegExp(`^`+Oe.call(ke).replace(we,`\\$&`).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,`$1.*?`)+`$`);function je(e){return!me(e)||be(e)?!1:(G(e)?Ae:Te).test(Ce(e))}var Me=je;function Ne(e,t){return e?.[t]}var Pe=Ne;function Fe(e,t){var n=Pe(e,t);return Me(n)?n:void 0}var Ie=Fe;function Le(){}var Re=Le;function ze(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var Be=ze;function Ve(e){return e!==e}var He=Ve;function Ue(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var We=Ue;function Ge(e,t,n){return t===t?We(e,t,n):Be(e,He,n)}var Ke=Ge;function qe(e,t){return!!(e!=null&&e.length)&&Ke(e,t,0)>-1}var Je=qe;function Ye(e,t){return e===t||e!==e&&t!==t}var Xe=Ye,q=Ie(Object,`create`);function Ze(){this.__data__=q?q(null):{},this.size=0}var Qe=Ze;function $e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var et=$e,tt=`__lodash_hash_undefined__`,nt=Object.prototype.hasOwnProperty;function rt(e){var t=this.__data__;if(q){var n=t[e];return n===tt?void 0:n}return nt.call(t,e)?t[e]:void 0}var it=rt,at=Object.prototype.hasOwnProperty;function ot(e){var t=this.__data__;return q?t[e]!==void 0:at.call(t,e)}var st=ot,ct=`__lodash_hash_undefined__`;function lt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=q&&t===void 0?ct:t,this}var ut=lt;function J(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}J.prototype.clear=Qe,J.prototype.delete=et,J.prototype.get=it,J.prototype.has=st,J.prototype.set=ut;var dt=J;function ft(){this.__data__=[],this.size=0}var pt=ft;function mt(e,t){for(var n=e.length;n--;)if(Xe(e[n][0],t))return n;return-1}var Y=mt,ht=Array.prototype.splice;function gt(e){var t=this.__data__,n=Y(t,e);return n<0?!1:(n==t.length-1?t.pop():ht.call(t,n,1),--this.size,!0)}var _t=gt;function vt(e){var t=this.__data__,n=Y(t,e);return n<0?void 0:t[n][1]}var yt=vt;function bt(e){return Y(this.__data__,e)>-1}var xt=bt;function St(e,t){var n=this.__data__,r=Y(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var Ct=St;function X(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}X.prototype.clear=pt,X.prototype.delete=_t,X.prototype.get=yt,X.prototype.has=xt,X.prototype.set=Ct;var wt=X,Tt=Ie(z,`Map`);function Et(){this.size=0,this.__data__={hash:new dt,map:new(Tt||wt),string:new dt}}var Dt=Et;function Ot(e){var t=typeof e;return t==`string`||t==`number`||t==`symbol`||t==`boolean`?e!==`__proto__`:e===null}var kt=Ot;function At(e,t){var n=e.__data__;return kt(t)?n[typeof t==`string`?`string`:`hash`]:n.map}var Z=At;function jt(e){var t=Z(this,e).delete(e);return this.size-=t?1:0,t}var Mt=jt;function Nt(e){return Z(this,e).get(e)}var Pt=Nt;function Ft(e){return Z(this,e).has(e)}var It=Ft;function Lt(e,t){var n=Z(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var Rt=Lt;function Q(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Q.prototype.clear=Dt,Q.prototype.delete=Mt,Q.prototype.get=Pt,Q.prototype.has=It,Q.prototype.set=Rt;var zt=Q,Bt=Ie(z,`Set`),Vt=`__lodash_hash_undefined__`;function Ht(e){return this.__data__.set(e,Vt),this}var Ut=Ht;function Wt(e){return this.__data__.has(e)}var Gt=Wt;function $(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new zt;++t<n;)this.add(e[t])}$.prototype.add=$.prototype.push=Ut,$.prototype.has=Gt;var Kt=$;function qt(e,t){return e.has(t)}var Jt=qt;function Yt(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var Xt=Yt;function Zt(e,t,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var Qt=Zt,$t=Bt&&1/Xt(new Bt([,-0]))[1]==1/0?function(e){return new Bt(e)}:Re,en=200;function tn(e,t,n){var r=-1,i=Je,a=e.length,o=!0,s=[],c=s;if(n)o=!1,i=Qt;else if(a>=en){var l=t?null:$t(e);if(l)return Xt(l);o=!1,i=Jt,c=new Kt}else c=t?[]:s;outer:for(;++r<a;){var u=e[r],d=t?t(u):u;if(u=n||u!==0?u:0,o&&d===d){for(var f=c.length;f--;)if(c[f]===d)continue outer;t&&c.push(d),s.push(u)}else i(c,d,n)||(c!==s&&c.push(d),s.push(u))}return s}var nn=tn;function rn(e){return e&&e.length?nn(e):[]}var an=rn,on={class:`flex flex-col gap-2`},sn={class:`flex flex-wrap items-center gap-2`},cn={class:`tabs-box tabs gap-2 tabs-sm`},ln=[`onClick`],un={class:`badge badge-sm`},dn={class:`flex items-center gap-2`},fn={class:`hidden text-sm sm:inline-block`},pn=[`checked`],mn=[`value`],hn={value:``},gn=[`value`],_n={class:`flex flex-wrap items-center gap-2`},vn={class:`flex shrink-0 items-center gap-1`},yn={class:`hidden text-sm whitespace-nowrap sm:inline-block`},bn=[`value`],xn=[`value`],Sn={class:`join flex min-w-0 flex-1 items-center`},Cn=[`placeholder`,`value`],wn=s({__name:`ConnectionsToolbar`,props:{tabs:{},activeTab:{},enableQuickFilter:{type:Boolean},sourceIPFilter:{},uniqueSourceIPs:{},sortColumn:{},sortDesc:{type:Boolean},sortableColumns:{},globalFilter:{},paused:{type:Boolean},isClosingConnections:{type:Boolean}},emits:[`update:activeTab`,`update:enableQuickFilter`,`update:sourceIPFilter`,`update:sortColumn`,`update:globalFilter`,`toggleSortOrder`,`togglePaused`,`closeConnections`,`openSettings`],setup(n,{emit:r}){let i=r,{t:a}=C();return(r,o)=>{let s=H;return v(),d(`div`,on,[e(`div`,sn,[e(`div`,cn,[(v(!0),d(l,null,b(n.tabs,r=>(v(),d(`button`,{key:r.type,class:w([`tab gap-2 px-2`,{"bg-primary text-neutral!":n.activeTab===r.type}]),onClick:e=>i(`update:activeTab`,r.type)},[e(`span`,null,t(r.name),1),e(`div`,un,t(r.count),1)],10,ln))),128))]),e(`div`,dn,[e(`span`,fn,t(h(a)(`quickFilter`)),1),e(`input`,{type:`checkbox`,class:`toggle toggle-sm`,checked:n.enableQuickFilter,onChange:o[0]||=e=>i(`update:enableQuickFilter`,e.target.checked)},null,40,pn)]),e(`select`,{class:`select max-w-40 flex-1 select-sm select-primary`,value:n.sourceIPFilter,onChange:o[1]||=e=>i(`update:sourceIPFilter`,e.target.value)},[e(`option`,hn,t(h(a)(`all`)),1),(v(!0),d(l,null,b(n.uniqueSourceIPs,e=>(v(),d(`option`,{key:e,value:e},t(e),9,gn))),128))],40,mn)]),e(`div`,_n,[e(`div`,vn,[e(`span`,yn,t(h(a)(`sortBy`)),1),e(`select`,{class:`select select-sm select-primary`,value:n.sortColumn,onChange:o[2]||=e=>i(`update:sortColumn`,e.target.value)},[(v(!0),d(l,null,b(n.sortableColumns,e=>(v(),d(`option`,{key:e.id,value:e.sortId},t(h(a)(e.key)),9,xn))),128))],40,bn),y(s,{class:`btn btn-sm btn-primary`,onClick:o[3]||=e=>i(`toggleSortOrder`)},{default:x(()=>[n.sortDesc?(v(),f(h(I),{key:0})):(v(),f(h(A),{key:1}))]),_:1})]),e(`div`,Sn,[e(`input`,{type:`search`,class:`input input-sm join-item min-w-0 flex-1 input-primary`,placeholder:h(a)(`search`),value:n.globalFilter,onInput:o[4]||=e=>i(`update:globalFilter`,e.target.value)},null,40,Cn),y(s,{class:`btn join-item btn-sm btn-primary`,onClick:o[5]||=e=>i(`togglePaused`)},{default:x(()=>[n.paused?(v(),f(h(j),{key:0})):(v(),f(h(F),{key:1}))]),_:1}),y(s,{class:`btn join-item btn-sm btn-primary`,loading:n.isClosingConnections,onClick:o[6]||=e=>i(`closeConnections`)},{default:x(()=>[y(h(ie))]),_:1},8,[`loading`]),y(s,{class:`btn join-item btn-sm btn-primary`,onClick:o[7]||=e=>i(`openSettings`)},{default:x(()=>[y(h(N))]),_:1})])])])}}}),Tn=Object.assign(wn,{__name:`ConnectionsToolbar`}),En={class:`join shrink-0`},Dn=[`disabled`],On=[`disabled`],kn={key:0,class:`flex items-center px-1 text-xs text-base-content/40`},An=[`onClick`],jn=[`disabled`],Mn=[`disabled`],Nn=s({__name:`ConnectionsPagination`,props:{currentPage:{},totalPages:{},visiblePages:{}},emits:[`goToPage`,`previous`,`next`],setup(n,{emit:r}){let i=r;return(r,o)=>(v(),d(`div`,En,[e(`button`,{class:`btn join-item btn-xs`,disabled:n.currentPage===0,onClick:o[0]||=e=>i(`goToPage`,0)},[y(h(k),{size:14})],8,Dn),e(`button`,{class:`btn join-item btn-xs`,disabled:n.currentPage===0,onClick:o[1]||=e=>i(`previous`)},[y(h(O),{size:14})],8,On),(v(!0),d(l,null,b(n.visiblePages,(r,o)=>(v(),d(l,{key:r},[o>0&&n.visiblePages[o-1]!==r-1?(v(),d(`span`,kn,` ··· `)):a(``,!0),e(`button`,{class:w([`btn join-item min-w-8 btn-xs`,{"btn-active":n.currentPage===r}]),onClick:e=>i(`goToPage`,r)},t(r+1),11,An)],64))),128)),e(`button`,{class:`btn join-item btn-xs`,disabled:n.currentPage>=n.totalPages-1,onClick:o[2]||=e=>i(`next`)},[y(h(re),{size:14})],8,jn),e(`button`,{class:`btn join-item btn-xs`,disabled:n.currentPage>=n.totalPages-1,onClick:o[3]||=e=>i(`goToPage`,n.totalPages-1)},[y(h(R),{size:14})],8,Mn)]))}}),Pn=Object.assign(Nn,{__name:`ConnectionsPagination`}),Fn={class:`min-h-0 flex-1 overflow-auto rounded-md bg-base-300`},In={class:`hidden md:table-header-group`},Ln={class:`flex items-center gap-2`},Rn=[`onClick`],zn=[`onClick`],Bn=[`onClick`],Vn=[`colspan`],Hn={class:`flex items-center gap-2`},Un={class:`text-base-content/60`},Wn=[`onClick`],Gn={class:`block text-xs text-base-content/60 md:hidden`},Kn={key:0,class:`py-8 text-center text-base-content/70`},qn=s({__name:`ConnectionsTable`,props:{columns:{},rowModel:{},sortColumn:{},sortDesc:{type:Boolean},groupingColumn:{},expandedGroups:{},tableSizeClass:{}},emits:[`headerClick`,`toggleGrouping`,`toggleGroupExpanded`,`rowClick`],setup(n,{emit:r}){let i=r,{t:s}=C();function c(e){return e.sortable&&!!e.sortId}function u(e,t){return e.sortId?t===e.sortId:!1}return(r,p)=>(v(),d(`div`,Fn,[e(`table`,{class:w([`table-pin-rows table table-zebra`,n.tableSizeClass])},[e(`thead`,In,[e(`tr`,null,[(v(!0),d(l,null,b(n.columns,r=>(v(),d(`th`,{key:r.id,class:`bg-base-200`},[e(`div`,Ln,[e(`div`,{class:w([`flex-1`,{"cursor-pointer select-none":c(r)}]),onClick:e=>i(`headerClick`,r.id)},t(h(s)(r.key)),11,Rn),u(r,n.sortColumn)&&!n.sortDesc?(v(),f(h(A),{key:0,size:16})):u(r,n.sortColumn)&&n.sortDesc?(v(),f(h(I),{key:1,size:16})):a(``,!0),r.groupable?(v(),d(`button`,{key:2,class:`cursor-pointer`,onClick:o(e=>i(`toggleGrouping`,r.id),[`stop`])},[n.groupingColumn===r.id?(v(),f(h(L),{key:0,size:18})):(v(),f(h(P),{key:1,size:18}))],8,zn)):a(``,!0)])]))),128))])]),e(`tbody`,null,[(v(!0),d(l,null,b(n.rowModel,r=>(v(),d(l,{key:r.type===`group`?`group-${r.key}`:r.original.id},[r.type===`group`?(v(),d(`tr`,{key:0,class:`cursor-pointer bg-base-200`,onClick:e=>i(`toggleGroupExpanded`,r.key)},[e(`td`,{colspan:n.columns.length},[e(`div`,Hn,[n.expandedGroups[r.key]?(v(),f(h(L),{key:0,size:18})):(v(),f(h(P),{key:1,size:18})),e(`span`,null,t(r.key),1),e(`span`,Un,`(`+t(r.subRows.length)+`)`,1)])],8,Vn)],8,Bn)):(v(),d(`tr`,{key:1,class:`flex cursor-pointer flex-wrap rounded-xl border-4 border-base-300 px-2 odd:bg-base-100 even:bg-base-200 md:table-row md:rounded-none md:border-0 md:px-0 md:hover:bg-base-200`,onClick:e=>i(`rowClick`,r.original)},[(v(!0),d(l,null,b(n.columns,n=>(v(),d(`td`,{key:n.id,class:`nth-2n:text-right sm:nth-2n:text-left sm:nth-3n:text-right md:nth-2n:text-start md:nth-3n:text-start w-1/2 min-w-1/2 pb-1.5 text-justify align-top wrap-break-word nth-last-2:mb-3 sm:w-1/3 sm:min-w-1/3 md:w-auto md:min-w-0 md:text-start md:align-middle md:whitespace-nowrap md:nth-last-2:mb-0`},[e(`span`,Gn,t(h(s)(n.key)),1),(v(),f(m(()=>n.render(r.original))))]))),128))],8,Wn))],64))),128))])],2),n.rowModel.length===0?(v(),d(`div`,Kn,t(h(s)(`noData`)),1)):a(``,!0)]))}}),Jn=Object.assign(qn,{__name:`ConnectionsTable`}),Yn={class:`flex flex-col gap-4`},Xn={value:`xs`},Zn={value:`sm`},Qn={value:`md`},$n={value:`lg`},er={class:`flex flex-col gap-4`},tr={class:`join flex`},nr=[`value`],rr={class:`flex flex-col gap-2`},ir={class:`truncate`},ar={class:`flex flex-col`},or=[`checked`,`onChange`],sr=s({__name:`ConnectionsSettingsModal`,props:{allColumns:{},untaggedSourceIPs:{}},setup(n,{expose:r}){let{t:a}=C(),o=ne(),s=_(),p=_(``),m=_(``);function ee(e){o.connectionsTableColumnVisibility={...o.connectionsTableColumnVisibility,[e]:!o.connectionsTableColumnVisibility[e]}}function S(){m.value&&p.value&&(o.clientSourceIPTags.some(e=>e.tagName===m.value||e.sourceIP===p.value)||(o.clientSourceIPTags=[...o.clientSourceIPTags,{tagName:m.value,sourceIP:p.value}]),m.value=``,p.value=``)}function w(e){o.clientSourceIPTags=o.clientSourceIPTags.filter(t=>t.tagName!==e)}function T(){o.connectionsTableColumnVisibility={...E}}return r({open:()=>s.value?.open(),close:()=>s.value?.close()}),(r,_)=>{let C=de,E=H,D=fe;return v(),f(D,{ref_key:`modalRef`,ref:s,title:h(a)(`connectionsSettings`)},{icon:x(()=>[y(h(M),{size:24})]),default:x(()=>[e(`div`,Yn,[e(`div`,null,[y(C,{"with-divider":``},{default:x(()=>[c(t(h(a)(`quickFilter`)),1)]),_:1}),g(e(`input`,{"onUpdate:modelValue":_[0]||=e=>h(o).quickFilterRegex=e,type:`text`,class:`input w-full`,placeholder:`DIRECT|direct|dns-out`},null,512),[[i,h(o).quickFilterRegex]])]),e(`div`,null,[y(C,{"with-divider":``},{default:x(()=>[c(t(h(a)(`tableSize`)),1)]),_:1}),g(e(`select`,{"onUpdate:modelValue":_[1]||=e=>h(o).connectionsTableSize=e,class:`select w-full`},[e(`option`,Xn,t(h(a)(`xs`)),1),e(`option`,Zn,t(h(a)(`sm`)),1),e(`option`,Qn,t(h(a)(`md`)),1),e(`option`,$n,t(h(a)(`lg`)),1)],512),[[u,h(o).connectionsTableSize]])]),e(`div`,null,[y(C,{"with-divider":``},{default:x(()=>[c(t(h(a)(`tagClientSourceIPWithName`)),1)]),_:1}),e(`div`,er,[e(`div`,tr,[g(e(`select`,{"onUpdate:modelValue":_[2]||=e=>te(p)?p.value=e:null,class:`select join-item`},[_[4]||=e(`option`,{value:``},null,-1),(v(!0),d(l,null,b(n.untaggedSourceIPs,e=>(v(),d(`option`,{key:e,value:e},t(e||h(a)(`inner`)),9,nr))),128))],512),[[u,h(p)]]),g(e(`input`,{"onUpdate:modelValue":_[3]||=e=>te(m)?m.value=e:null,class:`input join-item flex-1`,placeholder:`name`},null,512),[[i,h(m)]]),y(E,{class:`join-item`,onClick:S},{default:x(()=>[c(t(h(a)(`tag`)),1)]),_:1})]),e(`div`,rr,[(v(!0),d(l,null,b(h(o).clientSourceIPTags,n=>(v(),d(`div`,{key:n.tagName,class:`badge w-full items-center justify-between gap-2 py-4 badge-primary`},[e(`span`,ir,t(n.tagName)+` (`+t(n.sourceIP)+`)`,1),y(E,{class:`btn-circle btn-ghost btn-xs`,onClick:e=>w(n.tagName)},{default:x(()=>[y(h(ie),{size:12})]),_:1},8,[`onClick`])]))),128))])])]),e(`div`,null,[y(C,{"with-divider":``},{default:x(()=>[c(t(h(a)(`columns`)),1)]),_:1}),e(`div`,ar,[(v(!0),d(l,null,b(n.allColumns,n=>(v(),d(`div`,{key:n.id,class:`flex items-center justify-between py-2`},[e(`span`,null,t(h(a)(n.key)),1),e(`input`,{type:`checkbox`,class:`toggle`,checked:h(o).connectionsTableColumnVisibility[n.id],onChange:e=>ee(n.id)},null,40,or)]))),128))])]),y(E,{class:`btn-sm btn-neutral`,onClick:T},{default:x(()=>[c(t(h(a)(`reset`)),1)]),_:1})])]),_:1},8,[`title`])}}}),cr=Object.assign(sr,{__name:`ConnectionsSettingsModal`}),lr=r(V(),1),ur={key:0,class:`flex max-h-[70vh] flex-col gap-4 overflow-x-hidden overflow-y-auto`},dr={class:`rounded-box bg-base-200 p-3`},fr={class:`mb-2 font-semibold text-primary`},pr={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},mr={class:`min-w-0 font-mono break-all`},hr={class:`text-base-content/70`},gr={class:`text-base-content/70`},_r={class:`text-base-content/70`},vr={class:`break-all`},yr={class:`rounded-box bg-base-200 p-3`},br={class:`mb-2 font-semibold text-primary`},xr={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},Sr={class:`text-base-content/70`},Cr={class:`text-base-content/70`},wr={class:`text-base-content/70`},Tr={class:`text-base-content/70`},Er={class:`rounded-box bg-base-200 p-3`},Dr={class:`mb-2 font-semibold text-primary`},Or={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},kr={class:`text-base-content/70`},Ar={class:`text-base-content/70`},jr={class:`text-base-content/70`},Mr={class:`break-all`},Nr={class:`text-base-content/70`},Pr={class:`break-all`},Fr={class:`text-base-content/70`},Ir={class:`rounded-box bg-base-200 p-3`},Lr={class:`mb-2 font-semibold text-primary`},Rr={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},zr={class:`text-base-content/70`},Br={class:`min-w-0 font-mono break-all`},Vr={class:`text-base-content/70`},Hr={class:`min-w-0 font-mono break-all`},Ur={class:`text-base-content/70`},Wr={class:`min-w-0 font-mono break-all`},Gr={class:`rounded-box bg-base-200 p-3`},Kr={class:`mb-2 font-semibold text-primary`},qr={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},Jr={class:`text-base-content/70`},Yr={class:`text-base-content/70`},Xr={class:`min-w-0 font-mono break-all`},Zr={class:`text-base-content/70`},Qr={class:`rounded-box bg-base-200 p-3`},$r={class:`mb-2 font-semibold text-primary`},ei={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},ti={class:`text-base-content/70`},ni={class:`text-base-content/70`},ri={class:`min-w-0 text-xs break-all`},ii={class:`rounded-box bg-base-200 p-3`},ai={class:`mb-2 font-semibold text-primary`},oi={class:`flex flex-wrap gap-1`},si={key:0,class:`rounded-box bg-base-200 p-3`},ci={class:`mb-2 font-semibold text-primary`},li={class:`grid grid-cols-2 gap-x-4 gap-y-1 text-sm`},ui={class:`text-base-content/70`},di={class:`text-base-content/70`},fi=s({__name:`ConnectionDetailsModal`,props:{connection:{}},setup(n,{expose:r}){let i=_(),{t:o}=C();return r({open:()=>i.value?.open(),close:()=>i.value?.close()}),(r,s)=>{let c=fe;return v(),f(c,{ref_key:`modalRef`,ref:i,title:h(o)(`connectionsDetails`)},{icon:x(()=>[y(h(M),{size:24})]),default:x(()=>[n.connection?(v(),d(`div`,ur,[e(`div`,dr,[e(`div`,fr,t(h(o)(`basic`)),1),e(`div`,pr,[s[0]||=e(`div`,{class:`text-base-content/70`},`ID`,-1),e(`div`,mr,t(n.connection.id),1),e(`div`,hr,t(h(o)(`start`)),1),e(`div`,null,t(h(lr.default)(n.connection.start).format(`HH:mm:ss`)),1),e(`div`,gr,t(h(o)(`rule`)),1),e(`div`,null,t(n.connection.rule),1),e(`div`,_r,t(h(o)(`rulePayload`)),1),e(`div`,vr,t(n.connection.rulePayload||`-`),1)])]),e(`div`,yr,[e(`div`,br,t(h(o)(`traffic`)),1),e(`div`,xr,[e(`div`,Sr,t(h(o)(`download`)),1),e(`div`,null,t(h(B)(n.connection.download)),1),e(`div`,Cr,t(h(o)(`upload`)),1),e(`div`,null,t(h(B)(n.connection.upload)),1),e(`div`,wr,t(h(o)(`dlSpeed`)),1),e(`div`,null,t(h(B)(n.connection.downloadSpeed))+`/s`,1),e(`div`,Tr,t(h(o)(`ulSpeed`)),1),e(`div`,null,t(h(B)(n.connection.uploadSpeed))+`/s`,1)])]),e(`div`,Er,[e(`div`,Dr,t(h(o)(`metadata`)),1),e(`div`,Or,[e(`div`,kr,t(h(o)(`network`)),1),e(`div`,null,t(n.connection.metadata.network),1),e(`div`,Ar,t(h(o)(`type`)),1),e(`div`,null,t(n.connection.metadata.type),1),e(`div`,jr,t(h(o)(`host`)),1),e(`div`,Mr,t(n.connection.metadata.host||`-`),1),e(`div`,Nr,t(h(o)(`sniffHost`)),1),e(`div`,Pr,t(n.connection.metadata.sniffHost||`-`),1),e(`div`,Fr,t(h(o)(`dnsMode`)),1),e(`div`,null,t(n.connection.metadata.dnsMode||`-`),1)])]),e(`div`,Ir,[e(`div`,Lr,t(h(o)(`sourceAndDestination`)),1),e(`div`,Rr,[e(`div`,zr,t(h(o)(`source`)),1),e(`div`,Br,t(`${n.connection.metadata.sourceIP}:${n.connection.metadata.sourcePort}`),1),e(`div`,Vr,t(h(o)(`destination`)),1),e(`div`,Hr,t(n.connection.metadata.destinationIP?`${n.connection.metadata.destinationIP}:${n.connection.metadata.destinationPort}`:`${n.connection.metadata.host}:${n.connection.metadata.destinationPort}`),1),e(`div`,Ur,t(h(o)(`remoteDestination`)),1),e(`div`,Wr,t(n.connection.metadata.remoteDestination||`-`),1)])]),e(`div`,Gr,[e(`div`,Kr,t(h(o)(`inbound`)),1),e(`div`,qr,[e(`div`,Jr,t(h(o)(`inboundName`)),1),e(`div`,null,t(n.connection.metadata.inboundName||`-`),1),e(`div`,Yr,t(h(o)(`inboundIP`)),1),e(`div`,Xr,t(n.connection.metadata.inboundIP?`${n.connection.metadata.inboundIP}:${n.connection.metadata.inboundPort}`:`-`),1),e(`div`,Zr,t(h(o)(`inboundUser`)),1),e(`div`,null,t(n.connection.metadata.inboundUser||`-`),1)])]),e(`div`,Qr,[e(`div`,$r,t(h(o)(`process`)),1),e(`div`,ei,[e(`div`,ti,t(h(o)(`processName`)),1),e(`div`,null,t(n.connection.metadata.process||`-`),1),e(`div`,ni,t(h(o)(`processPath`)),1),e(`div`,ri,t(n.connection.metadata.processPath||`-`),1),s[1]||=e(`div`,{class:`text-base-content/70`},`UID`,-1),e(`div`,null,t(n.connection.metadata.uid||`-`),1)])]),e(`div`,ii,[e(`div`,ai,t(h(o)(`chains`)),1),e(`div`,oi,[(v(!0),d(l,null,b(n.connection.chains,(e,n)=>(v(),d(`span`,{key:n,class:`badge badge-neutral`},t(e),1))),128))])]),n.connection.metadata.specialProxy||n.connection.metadata.specialRules?(v(),d(`div`,si,[e(`div`,ci,t(h(o)(`special`)),1),e(`div`,li,[e(`div`,ui,t(h(o)(`specialProxy`)),1),e(`div`,null,t(n.connection.metadata.specialProxy||`-`),1),e(`div`,di,t(h(o)(`specialRules`)),1),e(`div`,null,t(n.connection.metadata.specialRules||`-`),1)])])):a(``,!0)])):a(``,!0)]),_:1},8,[`title`])}}}),pi=Object.assign(fi,{__name:`ConnectionDetailsModal`}),mi={class:`flex h-full flex-col gap-2`},hi={class:`flex shrink-0 items-center justify-center md:hidden`},gi={class:`hidden shrink-0 items-center justify-between gap-2 md:flex`},_i={class:`flex shrink-0 items-center gap-1.5`},vi=[`value`],yi={class:`text-xs whitespace-nowrap text-base-content/60`},bi=s({__name:`connections`,setup(r){let{t:i,locale:a}=C();n({title:T(()=>i(`connections`))});let o=se(),s=ne(),c=_(),f=_(),m=_(null),x=_(`active`),w=_(``),E=S(`enableQuickFilter`,!1),O=_(``),k=S(`connectionsTableSortColumn`,`ConnectTime`),A=S(`connectionsTableSortDesc`,!0),j=S(`connectionsTableGrouping`,null),M=_({}),N=_(0),P=S(`connectionsTablePageSize`,50),F=_(!1),I=e=>B(e).toString();function L(e){return e.metadata.process||e.metadata.processPath?.replace(/^.*[/\\](.*)$/,`$1`)||`-`}function R(e){return`${e.metadata.host||ue(e.metadata.destinationIP)}:${e.metadata.destinationPort}`}function z(e){return e.rulePayload?`${e.rule} : ${e.rulePayload}`:e.rule}function ce(e){let t=e.metadata.sourceIP||i(`inner`);return s.clientSourceIPTags.find(e=>e.sourceIP===t)?.tagName||t}function V(e){return e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host}function de(e){ae(e)}let H=[{id:D.Close,key:`close`,groupable:!1,sortable:!1,render:e=>p(`button`,{class:`btn btn-circle btn-xs`,onClick:t=>{t.stopPropagation(),de(e.id)}},p(ie,{size:16}))},{id:D.Type,key:`type`,groupable:!0,sortable:!0,sortId:`Type`,render:e=>`${e.metadata.type}(${e.metadata.network})`,groupValue:e=>`${e.metadata.type}(${e.metadata.network})`},{id:D.Process,key:`process`,groupable:!0,sortable:!0,sortId:`Process`,render:e=>L(e),groupValue:e=>L(e)},{id:D.Host,key:`host`,groupable:!0,sortable:!0,sortId:`Host`,render:e=>R(e),groupValue:e=>R(e)},{id:D.SniffHost,key:`sniffHost`,groupable:!0,sortable:!1,render:e=>e.metadata.sniffHost||`-`,groupValue:e=>e.metadata.sniffHost||`-`},{id:D.Rule,key:`rule`,groupable:!0,sortable:!1,render:e=>z(e),groupValue:e=>z(e)},{id:D.Chains,key:`chains`,groupable:!0,sortable:!1,render:e=>{let t=[...e.chains].reverse(),n=[];return t.forEach((e,t)=>{t>0&&n.push(p(re,{class:`inline-block`,size:18})),n.push(p(`span`,{class:`align-middle`},e))}),p(`span`,n)},groupValue:e=>e.chains.join(` > `)},{id:D.ConnectTime,key:`connectTime`,groupable:!1,sortable:!0,sortId:`ConnectTime`,render:e=>le(e.start,a.value)},{id:D.DlSpeed,key:`dlSpeed`,groupable:!1,sortable:!0,sortId:`DlSpeed`,render:e=>`${I(e.downloadSpeed)}/s`},{id:D.UlSpeed,key:`ulSpeed`,groupable:!1,sortable:!0,sortId:`UlSpeed`,render:e=>`${I(e.uploadSpeed)}/s`},{id:D.Download,key:`dl`,groupable:!1,sortable:!0,sortId:`Download`,render:e=>I(e.download)},{id:D.Upload,key:`ul`,groupable:!1,sortable:!0,sortId:`Upload`,render:e=>I(e.upload)},{id:D.SourceIP,key:`sourceIP`,groupable:!0,sortable:!0,sortId:`SourceIP`,render:e=>ce(e),groupValue:e=>ce(e)},{id:D.SourcePort,key:`sourcePort`,groupable:!1,sortable:!1,render:e=>String(e.metadata.sourcePort)},{id:D.Destination,key:`destination`,groupable:!0,sortable:!1,render:e=>V(e),groupValue:e=>V(e)}],fe=T(()=>H.filter(e=>s.connectionsTableColumnVisibility[e.id]!==!1)),pe=T(()=>H.filter(e=>e.sortable)),me=T(()=>[{type:`active`,name:i(`active`),count:o.activeConnections.length},{type:`closed`,name:i(`closed`),count:o.closedConnections.length}]),he=T(()=>an(o.allConnections.map(e=>{let t=e.metadata.sourceIP||i(`inner`);return s.clientSourceIPTags.find(e=>e.sourceIP===t)?.tagName||t})).sort()),ge=T(()=>an(o.allConnections.map(e=>e.metadata.sourceIP)).sort().filter(e=>!s.clientSourceIPTags.some(t=>t.sourceIP===e))),_e=T(()=>s.tableSizeClassName(s.connectionsTableSize)),U=T(()=>{let e=x.value===`active`?o.activeConnections:o.closedConnections;if(E.value&&s.quickFilterRegex)try{let t=new RegExp(s.quickFilterRegex,`i`);e=e.filter(e=>!e.chains.some(e=>t.test(e)))}catch{}if(O.value&&(e=e.filter(e=>{let t=e.metadata.sourceIP||i(`inner`);return(s.clientSourceIPTags.find(e=>e.sourceIP===t)?.tagName||t)===O.value})),w.value){let t=w.value.toLowerCase();e=e.filter(e=>e.metadata.host?.toLowerCase().includes(t)||e.metadata.process?.toLowerCase().includes(t)||e.metadata.sourceIP?.toLowerCase().includes(t)||e.rule?.toLowerCase().includes(t)||e.chains.some(e=>e.toLowerCase().includes(t)))}return[...e].sort((e,t)=>{let n=0;switch(k.value){case`ConnectTime`:n=new Date(e.start).getTime()-new Date(t.start).getTime();break;case`DlSpeed`:n=e.downloadSpeed-t.downloadSpeed;break;case`UlSpeed`:n=e.uploadSpeed-t.uploadSpeed;break;case`Download`:n=e.download-t.download;break;case`Upload`:n=e.upload-t.upload;break;case`Host`:n=(e.metadata.host||``).localeCompare(t.metadata.host||``);break;case`Type`:n=e.metadata.type.localeCompare(t.metadata.type);break;case`Process`:n=(e.metadata.process||``).localeCompare(t.metadata.process||``);break;case`SourceIP`:n=(e.metadata.sourceIP||``).localeCompare(t.metadata.sourceIP||``);break}return A.value?-n:n})}),W=T(()=>Math.max(1,Math.ceil(U.value.length/P.value))),G=T(()=>{let e=N.value,t=W.value,n=[];n.push(0);for(let r=Math.max(1,e-1);r<=Math.min(t-2,e+1);r++)n.includes(r)||n.push(r);return t>1&&!n.includes(t-1)&&n.push(t-1),n.sort((e,t)=>e-t)}),K=T(()=>{let e=N.value*P.value;return U.value.slice(e,e+P.value)}),ve=T(()=>{let e=U.value.length;return`${N.value*P.value+1}-${Math.min((N.value+1)*P.value,e)} / ${e}`});ee([x,w,O,E],()=>{N.value=0});let ye=T(()=>j.value?H.find(e=>e.id===j.value):null),be=T(()=>{let e=ye.value;if(!e?.groupValue)return K.value.map(e=>({type:`data`,original:e,depth:0}));let t=new Map;for(let n of U.value){let r=e.groupValue(n),i=t.get(r);i?i.push(n):t.set(r,[n])}let n=[];for(let[e,r]of t)if(n.push({type:`group`,key:e,depth:0,subRows:r}),M.value[e])for(let e of r)n.push({type:`data`,original:e,depth:1});return n});function xe(e){let t=H.find(t=>t.id===e);!t?.sortable||!t.sortId||(k.value===t.sortId?A.value?A.value=!1:(k.value=``,A.value=!0):(k.value=t.sortId,A.value=!0))}function Se(e){j.value===e?j.value=null:j.value=e,M.value={}}function Ce(e){M.value[e]=!M.value[e]}function we(){A.value=!A.value}async function Te(){F.value=!0;try{w.value?await Promise.allSettled(U.value.map(e=>ae(e.id))):await oe()}finally{F.value=!1}}function Ee(e){m.value=e,f.value?.open()}return(n,r)=>{let i=Tn,a=Pn,s=Jn,p=cr,_=pi;return v(),d(`div`,mi,[y(i,{tabs:h(me),"active-tab":h(x),"enable-quick-filter":h(E),"source-i-p-filter":h(O),"unique-source-i-ps":h(he),"sort-column":h(k),"sort-desc":h(A),"sortable-columns":h(pe),"global-filter":h(w),paused:h(o).paused,"is-closing-connections":h(F),"onUpdate:activeTab":r[0]||=e=>x.value=e,"onUpdate:enableQuickFilter":r[1]||=e=>E.value=e,"onUpdate:sourceIPFilter":r[2]||=e=>O.value=e,"onUpdate:sortColumn":r[3]||=e=>k.value=e,"onUpdate:globalFilter":r[4]||=e=>w.value=e,onToggleSortOrder:we,onTogglePaused:r[5]||=e=>h(o).paused=!h(o).paused,onCloseConnections:Te,onOpenSettings:r[6]||=e=>h(c)?.open()},null,8,[`tabs`,`active-tab`,`enable-quick-filter`,`source-i-p-filter`,`unique-source-i-ps`,`sort-column`,`sort-desc`,`sortable-columns`,`global-filter`,`paused`,`is-closing-connections`]),e(`div`,hi,[y(a,{"current-page":h(N),"total-pages":h(W),"visible-pages":h(G),onGoToPage:r[7]||=e=>N.value=e,onPrevious:r[8]||=e=>N.value--,onNext:r[9]||=e=>N.value++},null,8,[`current-page`,`total-pages`,`visible-pages`])]),y(s,{columns:h(fe),"row-model":h(be),"sort-column":h(k),"sort-desc":h(A),"grouping-column":h(j),"expanded-groups":h(M),"table-size-class":h(_e),onHeaderClick:xe,onToggleGrouping:Se,onToggleGroupExpanded:Ce,onRowClick:Ee},null,8,[`columns`,`row-model`,`sort-column`,`sort-desc`,`grouping-column`,`expanded-groups`,`table-size-class`]),e(`div`,gi,[e(`div`,_i,[g(e(`select`,{"onUpdate:modelValue":r[10]||=e=>te(P)?P.value=e:null,class:`select-bordered select select-xs`},[(v(),d(l,null,b([20,50,100,200],n=>e(`option`,{key:n,value:n},t(n),9,vi)),64))],512),[[u,h(P),void 0,{number:!0}]]),e(`span`,yi,t(h(ve)),1)]),y(a,{"current-page":h(N),"total-pages":h(W),"visible-pages":h(G),onGoToPage:r[11]||=e=>N.value=e,onPrevious:r[12]||=e=>N.value--,onNext:r[13]||=e=>N.value++},null,8,[`current-page`,`total-pages`,`visible-pages`])]),y(p,{ref_key:`settingsModal`,ref:c,"all-columns":H,"untagged-source-i-ps":h(ge)},null,8,[`untagged-source-i-ps`]),y(_,{ref_key:`detailsModal`,ref:f,connection:h(m)},null,8,[`connection`])])}}});export{bi as default};