import{B as e,Ct as t,D as n,F as r,H as i,I as a,J as o,K as s,L as c,P as l,U as u,V as d,Y as f,at as ee,bt as p,ct as m,mt as h,nt as g,q as _,rt as v,st as y,ut as te,w as b,x as ne,xt as x,z as S}from"./BUwZQTr6.js";import{u as C}from"./_v7-ePgP.js";import{t as re}from"./Bxfoq5Is.js";import{c as ie,f as ae,l as oe,n as w,p as se,s as ce,t as T,x as le}from"./BNAMIMxA.js";import{t as ue}from"./BWNecmep.js";import{t as de}from"./-DwGYZJK.js";import{t as fe}from"./BAU4SYdC.js";import{t as pe}from"./YM027S49.js";var me={class:`flex h-full flex-col gap-2`},he={class:`join w-full`},ge=[`placeholder`],E={class:`flex-1 overflow-x-auto rounded-md bg-base-300 whitespace-nowrap`},D={class:`flex items-center gap-2`},O=[`onClick`],k=[`onClick`],A=[`onClick`],j=[`colspan`],M={class:`flex items-center gap-2`},N={class:`text-base-content/60`},P={key:1,class:`hover`},F={key:0,class:`py-8 text-center text-base-content/70`},I={class:`flex flex-col gap-4`},L={value:`xs`},_e={value:`sm`},ve={value:`md`},ye={value:`lg`},R={value:`info`},be={value:`error`},xe={value:`warning`},Se={value:`debug`},Ce={value:`silent`},z=o({__name:`logs`,setup(o){let{t:z}=ne();n({title:S(()=>z(`logs`))});let B=ue(),V=re(),H=h(``),U=h();function W(e){return e.match(/^\[([^\]]+)\]/)?.[1]??``}function we(e){switch(e){case C.Error:return`text-error`;case C.Warning:return`text-warning`;case C.Info:return`text-info`;case C.Debug:return`text-success`;default:return``}}let G=[{id:`seq`,label:z(`sequence`),sortable:!0,groupable:!1,render:e=>String(e.seq),sortValue:e=>e.seq},{id:`level`,label:z(`level`),sortable:!0,groupable:!0,render:e=>f(`span`,{class:we(e.type)},`[${e.type}]`),sortValue:e=>e.type,groupValue:e=>e.type},{id:`type`,label:z(`type`),sortable:!0,groupable:!0,render:e=>f(`span`,{class:`opacity-70`},W(e.payload)),sortValue:e=>W(e.payload),groupValue:e=>W(e.payload)||`(empty)`},{id:`payload`,label:z(`payload`),sortable:!1,groupable:!1,render:e=>e.payload}],K=b(`logsTableSortColumn`,`seq`),q=b(`logsTableSortDesc`,!0),J=b(`logsTableGrouping`,null),Y=h({}),X=S(()=>{if(!H.value)return B.logs;let e=H.value.toLowerCase();return B.logs.filter(t=>t.payload.toLowerCase().includes(e)||t.type.toLowerCase().includes(e)||W(t.payload).toLowerCase().includes(e))}),Z=S(()=>{let e=G.find(e=>e.id===K.value);return e?.sortValue?[...X.value].sort((t,n)=>{let r=e.sortValue(t),i=e.sortValue(n),a=0;return typeof r==`number`&&typeof i==`number`?a=r-i:typeof r==`string`&&typeof i==`string`&&(a=r.localeCompare(i)),q.value?-a:a}):X.value}),Te=S(()=>J.value?G.find(e=>e.id===J.value):null),Q=S(()=>{let e=Te.value;if(!e?.groupValue)return Z.value.map(e=>({type:`data`,original:e}));let t=new Map;for(let n of Z.value){let r=e.groupValue(n),i=t.get(r);i?i.push(n):t.set(r,[n])}let n=[];for(let[e,r]of t)if(n.push({type:`group`,key:e,subRows:r}),Y.value[e])for(let e of r)n.push({type:`data`,original:e});return n});function Ee(e){return G.find(t=>t.id===e)?.sortable??!1}function $(e){return K.value===e}function De(e){G.find(t=>t.id===e)?.sortable&&(K.value===e?q.value?q.value=!1:(K.value=``,q.value=!0):(K.value=e,q.value=!0))}function Oe(e){J.value===e?J.value=null:J.value=e,Y.value={}}function ke(e){Y.value[e]=!Y.value[e]}let Ae=S(()=>V.tableSizeClassName(V.logsTableSize));return(n,o)=>{let f=fe,h=de,b=pe;return g(),u(`div`,me,[e(`div`,he,[m(e(`input`,{"onUpdate:modelValue":o[0]||=e=>te(H)?H.value=e:null,type:`search`,class:`input input-sm join-item flex-1 shrink-0 input-primary`,placeholder:p(z)(`search`)},null,8,ge),[[r,p(H)]]),_(f,{class:`btn join-item btn-sm btn-primary`,onClick:o[1]||=e=>p(B).togglePaused()},{default:y(()=>[p(B).paused?(g(),d(p(ae),{key:1})):(g(),d(p(se),{key:0}))]),_:1}),_(f,{class:`btn join-item btn-sm btn-primary`,onClick:o[2]||=e=>p(U)?.open()},{default:y(()=>[_(p(oe))]),_:1})]),e(`div`,E,[e(`table`,{class:x([`table-pin-rows table table-zebra`,p(Ae)])},[e(`thead`,null,[e(`tr`,null,[(g(),u(c,null,v(G,n=>e(`th`,{key:n.id,class:`bg-base-200`},[e(`div`,D,[e(`div`,{class:x([`flex-1`,{"cursor-pointer select-none":Ee(n.id)}]),onClick:e=>De(n.id)},t(n.label),11,O),$(n.id)&&!p(q)?(g(),d(p(ie),{key:0,size:16})):$(n.id)&&p(q)?(g(),d(p(ce),{key:1,size:16})):i(``,!0),n.groupable?(g(),u(`button`,{key:2,class:`cursor-pointer`,onClick:a(e=>Oe(n.id),[`stop`])},[p(J)===n.id?(g(),d(p(T),{key:0,size:18})):(g(),d(p(w),{key:1,size:18}))],8,k)):i(``,!0)])])),64))])]),e(`tbody`,null,[(g(!0),u(c,null,v(p(Q),n=>(g(),u(c,{key:n.type===`group`?`group-${n.key}`:n.original.seq},[n.type===`group`?(g(),u(`tr`,{key:0,class:`cursor-pointer bg-base-200`,onClick:e=>ke(n.key)},[e(`td`,{colspan:G.length},[e(`div`,M,[p(Y)[n.key]?(g(),d(p(T),{key:0,size:18})):(g(),d(p(w),{key:1,size:18})),e(`span`,null,t(n.key),1),e(`span`,N,`(`+t(n.subRows.length)+`)`,1)])],8,j)],8,A)):(g(),u(`tr`,P,[(g(),u(c,null,v(G,t=>e(`td`,{key:t.id,class:`whitespace-nowrap`},[(g(),d(ee(()=>t.render(n.original))))])),64))]))],64))),128))])],2),p(Q).length===0?(g(),u(`div`,F,t(p(z)(`noData`)),1)):i(``,!0)]),_(b,{ref_key:`settingsModal`,ref:U,title:p(z)(`logsSettings`)},{icon:y(()=>[_(p(le),{size:24})]),default:y(()=>[e(`div`,I,[e(`div`,null,[_(h,{"with-divider":``},{default:y(()=>[s(t(p(z)(`tableSize`)),1)]),_:1}),m(e(`select`,{"onUpdate:modelValue":o[3]||=e=>p(V).logsTableSize=e,class:`select w-full`},[e(`option`,L,t(p(z)(`xs`)),1),e(`option`,_e,t(p(z)(`sm`)),1),e(`option`,ve,t(p(z)(`md`)),1),e(`option`,ye,t(p(z)(`lg`)),1)],512),[[l,p(V).logsTableSize]])]),e(`div`,null,[_(h,{"with-divider":``},{default:y(()=>[s(t(p(z)(`logLevel`)),1)]),_:1}),m(e(`select`,{"onUpdate:modelValue":o[4]||=e=>p(V).logLevel=e,class:`select w-full`},[e(`option`,R,t(p(z)(`info`)),1),e(`option`,be,t(p(z)(`error`)),1),e(`option`,xe,t(p(z)(`warning`)),1),e(`option`,Se,t(p(z)(`debug`)),1),e(`option`,Ce,t(p(z)(`silent`)),1)],512),[[l,p(V).logLevel]])]),e(`div`,null,[_(h,{"with-divider":``},{default:y(()=>[s(t(p(z)(`logMaxRows`)),1)]),_:1}),m(e(`select`,{"onUpdate:modelValue":o[5]||=e=>p(V).logMaxRows=e,class:`select w-full`},[...o[6]||=[e(`option`,{value:200},`200`,-1),e(`option`,{value:300},`300`,-1),e(`option`,{value:500},`500`,-1),e(`option`,{value:800},`800`,-1),e(`option`,{value:1e3},`1000`,-1)]],512),[[l,p(V).logMaxRows]])])])]),_:1},8,[`title`])])}}});export{z as default};